<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Button Masher - Multiplayer Game</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .container {
            background: white;
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            max-width: 800px;
            width: 100%;
        }

        h1 {
            text-align: center;
            color: #333;
            margin-bottom: 30px;
            font-size: 2.5em;
        }

        .setup-screen,
        .game-screen,
        .results-screen {
            display: none;
        }

        .setup-screen.active,
        .game-screen.active,
        .results-screen.active {
            display: block;
        }

        .player-setup {
            margin-bottom: 30px;
        }

        .player-input {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
            align-items: center;
        }

        .player-input input {
            flex: 1;
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 16px;
        }

        .player-input input:focus {
            outline: none;
            border-color: #667eea;
        }

        .color-picker {
            width: 60px;
            height: 45px;
            border: 2px solid #ddd;
            border-radius: 8px;
            cursor: pointer;
        }

        .btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 10px;
            font-size: 18px;
            cursor: pointer;
            transition: transform 0.1s;
            width: 100%;
            margin-top: 10px;
        }

        .btn:hover {
            transform: translateY(-2px);
        }

        .btn:active {
            transform: translateY(0);
        }

        .timer {
            text-align: center;
            font-size: 3em;
            font-weight: bold;
            color: #667eea;
            margin: 30px 0;
        }

        .countdown {
            text-align: center;
            font-size: 5em;
            font-weight: bold;
            color: #764ba2;
            margin: 50px 0;
        }

        .players-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }

        .player-box {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 20px;
            text-align: center;
            border: 3px solid transparent;
        }

        .player-name {
            font-size: 1.2em;
            font-weight: bold;
            margin-bottom: 15px;
        }

        .player-score {
            font-size: 3em;
            font-weight: bold;
            margin: 20px 0;
        }

        .smash-button {
            width: 100%;
            height: 120px;
            border: none;
            border-radius: 15px;
            font-size: 1.5em;
            font-weight: bold;
            color: white;
            cursor: pointer;
            transition: transform 0.05s;
            text-transform: uppercase;
        }

        .smash-button:hover {
            transform: scale(1.05);
        }

        .smash-button:active {
            transform: scale(0.95);
        }

        .smash-button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .winner {
            border-color: gold;
            animation: pulse 1s infinite;
        }

        @keyframes pulse {

            0%,
            100% {
                transform: scale(1);
            }

            50% {
                transform: scale(1.05);
            }
        }

        .trophy {
            font-size: 3em;
            margin-bottom: 20px;
        }

        .results-list {
            margin: 30px 0;
        }

        .result-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px;
            margin: 10px 0;
            background: #f8f9fa;
            border-radius: 10px;
            font-size: 1.2em;
        }

        .result-rank {
            font-weight: bold;
            color: #667eea;
            width: 40px;
        }

        .result-name {
            flex: 1;
            font-weight: bold;
        }

        .result-score {
            font-weight: bold;
            color: #764ba2;
        }

        .instructions {
            background: #e3f2fd;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
            line-height: 1.6;
        }

        .add-player-btn {
            background: #28a745;
            margin-top: 10px;
        }

        .remove-player-btn {
            background: #dc3545;
            padding: 10px 20px;
            font-size: 14px;
            margin-left: 10px;
        }
    </style>
</head>

<body>
    <div class="container">
        <h1>üéÆ Button Masher üéÆ</h1>

        <!-- Setup Screen -->
        <div class="setup-screen active">
            <div class="instructions">
                <strong>How to Play:</strong><br>
                1. Enter names for 2-4 players<br>
                2. Each player opens this game in their own browser tab<br>
                3. When the game starts, click your button as fast as you can!<br>
                4. Most clicks in 10 seconds wins!
            </div>

            <div class="player-setup" id="playerSetup">
                <div class="player-input">
                    <input type="text" placeholder="Player 1 Name" data-player="0" value="Player 1">
                    <input type="color" class="color-picker" data-player="0" value="#ff6b6b">
                </div>
                <div class="player-input">
                    <input type="text" placeholder="Player 2 Name" data-player="1" value="Player 2">
                    <input type="color" class="color-picker" data-player="1" value="#4ecdc4">
                </div>
            </div>

            <button class="btn add-player-btn" onclick="addPlayer()">‚ûï Add Player</button>
            <button class="btn" onclick="startGame()">Start Game</button>
        </div>

        <!-- Game Screen -->
        <div class="game-screen">
            <div class="countdown" id="countdown">3</div>
            <div class="timer" id="timer">10</div>
            <div class="players-grid" id="playersGrid"></div>
        </div>

        <!-- Results Screen -->
        <div class="results-screen">
            <div style="text-align: center;">
                <div class="trophy">üèÜ</div>
                <h2 id="winnerName" style="color: #667eea; margin-bottom: 30px;">Winner!</h2>
            </div>
            <div class="results-list" id="resultsList"></div>
            <button class="btn" onclick="resetGame()">Play Again</button>
        </div>
    </div>

    <script>
        // Game state stored in localStorage for cross-tab communication
        const GAME_KEY = 'buttonMasherGame';
        let playerCount = 2;
        let gameState = {
            status: 'setup', // setup, countdown, playing, finished
            players: [],
            scores: [],
            timeLeft: 10,
            countdownValue: 3
        };

        // Initialize game state
        function initGame() {
            const saved = localStorage.getItem(GAME_KEY);
            if (saved) {
                gameState = JSON.parse(saved);
                updateDisplay();
            }
        }

        // Save game state
        function saveGame() {
            localStorage.setItem(GAME_KEY, JSON.stringify(gameState));
            window.dispatchEvent(new Event('storage'));
        }

        // Listen for changes from other tabs
        window.addEventListener('storage', (e) => {
            if (e.key === GAME_KEY) {
                const saved = localStorage.getItem(GAME_KEY);
                if (saved) {
                    gameState = JSON.parse(saved);
                    updateDisplay();
                }
            }
        });

        // Add player
        function addPlayer() {
            if (playerCount >= 4) {
                alert('Maximum 4 players allowed!');
                return;
            }
            playerCount++;
            const setup = document.getElementById('playerSetup');
            const colors = ['#95e1d3', '#f38181', '#aa96da', '#fcbad3'];
            const div = document.createElement('div');
            div.className = 'player-input';
            div.innerHTML = `
                <input type="text" placeholder="Player ${playerCount} Name" data-player="${playerCount - 1}" value="Player ${playerCount}">
                <input type="color" class="color-picker" data-player="${playerCount - 1}" value="${colors[playerCount - 1] || '#95e1d3'}">
                <button class="btn remove-player-btn" onclick="removePlayer(this)">‚úñ</button>
            `;
            setup.appendChild(div);
        }

        // Remove player
        function removePlayer(btn) {
            if (playerCount <= 2) {
                alert('Minimum 2 players required!');
                return;
            }
            btn.parentElement.remove();
            playerCount--;
        }

        // Start game
        function startGame() {
            const inputs = document.querySelectorAll('input[type="text"]');
            const colors = document.querySelectorAll('.color-picker');

            gameState.players = [];
            gameState.scores = [];

            inputs.forEach((input, index) => {
                if (input.value.trim()) {
                    gameState.players.push({
                        name: input.value.trim(),
                        color: colors[index].value
                    });
                    gameState.scores.push(0);
                }
            });

            if (gameState.players.length < 2) {
                alert('Please enter at least 2 player names!');
                return;
            }

            gameState.status = 'countdown';
            gameState.countdownValue = 3;
            gameState.timeLeft = 10;
            saveGame();
            startCountdown();
        }

        // Countdown before game starts
        function startCountdown() {
            const countdownInterval = setInterval(() => {
                gameState.countdownValue--;
                saveGame();

                if (gameState.countdownValue <= 0) {
                    clearInterval(countdownInterval);
                    gameState.status = 'playing';
                    saveGame();
                    startGameTimer();
                }
            }, 1000);
        }

        // Game timer
        function startGameTimer() {
            const timerInterval = setInterval(() => {
                gameState.timeLeft--;
                saveGame();

                if (gameState.timeLeft <= 0) {
                    clearInterval(timerInterval);
                    endGame();
                }
            }, 1000);
        }

        // Handle button click
        function clickButton(playerIndex) {
            if (gameState.status === 'playing') {
                gameState.scores[playerIndex]++;
                saveGame();
            }
        }

        // End game
        function endGame() {
            gameState.status = 'finished';
            saveGame();
        }

        // Reset game
        function resetGame() {
            localStorage.removeItem(GAME_KEY);
            location.reload();
        }

        // Update display based on game state
        function updateDisplay() {
            const setupScreen = document.querySelector('.setup-screen');
            const gameScreen = document.querySelector('.game-screen');
            const resultsScreen = document.querySelector('.results-screen');

            setupScreen.classList.remove('active');
            gameScreen.classList.remove('active');
            resultsScreen.classList.remove('active');

            if (gameState.status === 'setup') {
                setupScreen.classList.add('active');
            } else if (gameState.status === 'countdown') {
                gameScreen.classList.add('active');
                document.getElementById('countdown').style.display = 'block';
                document.getElementById('timer').style.display = 'none';
                document.getElementById('countdown').textContent = gameState.countdownValue;
                document.getElementById('playersGrid').innerHTML = '';
            } else if (gameState.status === 'playing') {
                gameScreen.classList.add('active');
                document.getElementById('countdown').style.display = 'none';
                document.getElementById('timer').style.display = 'block';
                document.getElementById('timer').textContent = gameState.timeLeft;
                updatePlayersGrid();
            } else if (gameState.status === 'finished') {
                resultsScreen.classList.add('active');
                showResults();
            }
        }

        // Update players grid
        function updatePlayersGrid() {
            const grid = document.getElementById('playersGrid');
            grid.innerHTML = '';

            gameState.players.forEach((player, index) => {
                const box = document.createElement('div');
                box.className = 'player-box';
                box.innerHTML = `
                    <div class="player-name" style="color: ${player.color}">${player.name}</div>
                    <div class="player-score">${gameState.scores[index]}</div>
                    <button class="smash-button" 
                            style="background: ${player.color}"
                            onclick="clickButton(${index})">
                        SMASH!
                    </button>
                `;
                grid.appendChild(box);
            });
        }

        // Show results
        function showResults() {
            const results = gameState.players.map((player, index) => ({
                name: player.name,
                color: player.color,
                score: gameState.scores[index]
            })).sort((a, b) => b.score - a.score);

            document.getElementById('winnerName').textContent = `${results[0].name} Wins!`;
            document.getElementById('winnerName').style.color = results[0].color;

            const resultsList = document.getElementById('resultsList');
            resultsList.innerHTML = '';

            results.forEach((result, index) => {
                const item = document.createElement('div');
                item.className = 'result-item';
                item.innerHTML = `
                    <span class="result-rank">#${index + 1}</span>
                    <span class="result-name" style="color: ${result.color}">${result.name}</span>
                    <span class="result-score">${result.score} clicks</span>
                `;
                resultsList.appendChild(item);
            });
        }

        // Initialize on load
        initGame();
    </script>
</body>

</html>